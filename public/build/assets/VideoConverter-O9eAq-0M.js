var xe=Object.defineProperty;var le=r=>{throw TypeError(r)};var ke=(r,o,l)=>o in r?xe(r,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[o]=l;var x=(r,o,l)=>ke(r,typeof o!="symbol"?o+"":o,l),re=(r,o,l)=>o.has(r)||le("Cannot "+l);var u=(r,o,l)=>(re(r,o,"read from private field"),l?l.call(r):o.get(r)),U=(r,o,l)=>o.has(r)?le("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(r):o.set(r,l),K=(r,o,l,n)=>(re(r,o,"write to private field"),n?n.call(r,l):o.set(r,l),l);import{d as ye,r as b,f as Ee,g as Fe,o as D,w as Re,b as e,a as L,i as C,t as I,n as De,j as Y,v as q,k as se,l as ne,m as Le}from"./app-ClTWCkFA.js";import{_ as Me}from"./Layout.vue_vue_type_script_setup_true_lang-eghGUf9P.js";var m;(function(r){r.LOAD="LOAD",r.EXEC="EXEC",r.FFPROBE="FFPROBE",r.WRITE_FILE="WRITE_FILE",r.READ_FILE="READ_FILE",r.DELETE_FILE="DELETE_FILE",r.RENAME="RENAME",r.CREATE_DIR="CREATE_DIR",r.LIST_DIR="LIST_DIR",r.DELETE_DIR="DELETE_DIR",r.ERROR="ERROR",r.DOWNLOAD="DOWNLOAD",r.PROGRESS="PROGRESS",r.LOG="LOG",r.MOUNT="MOUNT",r.UNMOUNT="UNMOUNT"})(m||(m={}));const Oe=(()=>{let r=0;return()=>r++})(),Ie=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),Ce=new Error("called FFmpeg.terminate()");var R,B,A,T,N,Z,k;class ie{constructor(){U(this,R,null);U(this,B,{});U(this,A,{});U(this,T,[]);U(this,N,[]);x(this,"loaded",!1);U(this,Z,()=>{u(this,R)&&(u(this,R).onmessage=({data:{id:o,type:l,data:n}})=>{switch(l){case m.LOAD:this.loaded=!0,u(this,B)[o](n);break;case m.MOUNT:case m.UNMOUNT:case m.EXEC:case m.FFPROBE:case m.WRITE_FILE:case m.READ_FILE:case m.DELETE_FILE:case m.RENAME:case m.CREATE_DIR:case m.LIST_DIR:case m.DELETE_DIR:u(this,B)[o](n);break;case m.LOG:u(this,T).forEach(i=>i(n));break;case m.PROGRESS:u(this,N).forEach(i=>i(n));break;case m.ERROR:u(this,A)[o](n);break}delete u(this,B)[o],delete u(this,A)[o]})});U(this,k,({type:o,data:l},n=[],i)=>u(this,R)?new Promise((d,h)=>{const y=Oe();u(this,R)&&u(this,R).postMessage({id:y,type:o,data:l},n),u(this,B)[y]=d,u(this,A)[y]=h,i==null||i.addEventListener("abort",()=>{h(new DOMException(`Message # ${y} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(Ie));x(this,"load",({classWorkerURL:o,...l}={},{signal:n}={})=>(u(this,R)||(K(this,R,o?new Worker(new URL(o,import.meta.url),{type:"module"}):new Worker(new URL("/build/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),u(this,Z).call(this)),u(this,k).call(this,{type:m.LOAD,data:l},void 0,n)));x(this,"exec",(o,l=-1,{signal:n}={})=>u(this,k).call(this,{type:m.EXEC,data:{args:o,timeout:l}},void 0,n));x(this,"ffprobe",(o,l=-1,{signal:n}={})=>u(this,k).call(this,{type:m.FFPROBE,data:{args:o,timeout:l}},void 0,n));x(this,"terminate",()=>{const o=Object.keys(u(this,A));for(const l of o)u(this,A)[l](Ce),delete u(this,A)[l],delete u(this,B)[l];u(this,R)&&(u(this,R).terminate(),K(this,R,null),this.loaded=!1)});x(this,"writeFile",(o,l,{signal:n}={})=>{const i=[];return l instanceof Uint8Array&&i.push(l.buffer),u(this,k).call(this,{type:m.WRITE_FILE,data:{path:o,data:l}},i,n)});x(this,"mount",(o,l,n)=>{const i=[];return u(this,k).call(this,{type:m.MOUNT,data:{fsType:o,options:l,mountPoint:n}},i)});x(this,"unmount",o=>{const l=[];return u(this,k).call(this,{type:m.UNMOUNT,data:{mountPoint:o}},l)});x(this,"readFile",(o,l="binary",{signal:n}={})=>u(this,k).call(this,{type:m.READ_FILE,data:{path:o,encoding:l}},void 0,n));x(this,"deleteFile",(o,{signal:l}={})=>u(this,k).call(this,{type:m.DELETE_FILE,data:{path:o}},void 0,l));x(this,"rename",(o,l,{signal:n}={})=>u(this,k).call(this,{type:m.RENAME,data:{oldPath:o,newPath:l}},void 0,n));x(this,"createDir",(o,{signal:l}={})=>u(this,k).call(this,{type:m.CREATE_DIR,data:{path:o}},void 0,l));x(this,"listDir",(o,{signal:l}={})=>u(this,k).call(this,{type:m.LIST_DIR,data:{path:o}},void 0,l));x(this,"deleteDir",(o,{signal:l}={})=>u(this,k).call(this,{type:m.DELETE_DIR,data:{path:o}},void 0,l))}on(o,l){o==="log"?u(this,T).push(l):o==="progress"&&u(this,N).push(l)}off(o,l){o==="log"?K(this,T,u(this,T).filter(n=>n!==l)):o==="progress"&&K(this,N,u(this,N).filter(n=>n!==l))}}R=new WeakMap,B=new WeakMap,A=new WeakMap,T=new WeakMap,N=new WeakMap,Z=new WeakMap,k=new WeakMap;var ue;(function(r){r.MEMFS="MEMFS",r.NODEFS="NODEFS",r.NODERAWFS="NODERAWFS",r.IDBFS="IDBFS",r.WORKERFS="WORKERFS",r.PROXYFS="PROXYFS"})(ue||(ue={}));const Ae=new Error("failed to get response body reader"),$e=new Error("failed to complete download"),Se="Content-Length",Ve=r=>new Promise((o,l)=>{const n=new FileReader;n.onload=()=>{const{result:i}=n;i instanceof ArrayBuffer?o(new Uint8Array(i)):o(new Uint8Array)},n.onerror=i=>{var d,h;l(Error(`File could not be read! Code=${((h=(d=i==null?void 0:i.target)==null?void 0:d.error)==null?void 0:h.code)||-1}`))},n.readAsArrayBuffer(r)}),ee=async r=>{let o;if(typeof r=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(r)?o=atob(r.split(",")[1]).split("").map(l=>l.charCodeAt(0)):o=await(await fetch(r)).arrayBuffer();else if(r instanceof URL)o=await(await fetch(r)).arrayBuffer();else if(r instanceof File||r instanceof Blob)o=await Ve(r);else return new Uint8Array;return new Uint8Array(o)},_e=async(r,o)=>{var i;const l=await fetch(r);let n;try{const d=parseInt(l.headers.get(Se)||"-1"),h=(i=l.body)==null?void 0:i.getReader();if(!h)throw Ae;const y=[];let $=0;for(;;){const{done:g,value:V}=await h.read(),E=V?V.length:0;if(g){if(d!=-1&&d!==$)throw $e;o&&o({url:r,total:d,received:$,delta:E,done:g});break}y.push(V),$+=E,o&&o({url:r,total:d,received:$,delta:E,done:g})}const j=new Uint8Array($);let S=0;for(const g of y)j.set(g,S),S+=g.length;n=j.buffer}catch(d){console.log("failed to send download progress event: ",d),n=await l.arrayBuffer()}return n},G=async(r,o,l=!1,n)=>{const i=l?await _e(r,n):await(await fetch(r)).arrayBuffer(),d=new Blob([i],{type:o});return URL.createObjectURL(d)},Ue={class:"max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8"},Be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8"},Te={class:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md"},Ne={class:"flex items-center"},je={class:"text-blue-800 dark:text-blue-200"},Pe={class:"mb-8"},We={class:"mt-4"},He={key:0,class:"mt-2 text-sm text-blue-600 dark:text-blue-400"},ze={key:1,class:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-md"},Xe={class:"grid grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400"},Ke={class:"mb-8"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Qe={class:"text-center space-y-4"},Ye=["disabled"],qe={key:0,class:"inline-block h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ze={key:1,class:"inline-block h-5 w-5 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Je={key:0,class:"mt-8"},et={class:"bg-gray-200 dark:bg-gray-700 rounded-full h-2"},tt={key:1,class:"mt-8"},ot={class:"bg-gray-200 dark:bg-gray-700 rounded-full h-2"},at={key:2,class:"mt-8 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md"},lt={class:"space-y-4"},rt={class:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md"},st={class:"text-blue-800 dark:text-blue-200 text-sm"},nt={class:"space-y-2"},it={key:0,class:"space-y-2"},ut=["src"],te="https://cdn.jsdelivr.net/npm/@ffmpeg/core-mt@0.12.10/dist/esm",vt=ye({__name:"VideoConverter",setup(r){const o=b(!1),l=b(!1),n=b(!1),i=b(0),d=b(null),h=b(null),y=b(""),$=b("è¯·é€‰æ‹©è§†é¢‘æ–‡ä»¶å¼€å§‹è½¬æ¢"),j=b(!1),S=b(!1),g=b("ç‚¹å‡»åŠ è½½FFmpeg"),V=b("");let E=null;const F=b(null),c=b(null),f=a=>{$.value=a,console.log(`[VideoConverter] ${a}`)},P=b("mp4"),W=b("high"),H=b("original"),z=b("original"),p=new ie;Ee(async()=>{p.off("log"),p.off("progress"),p.on("log",({message:a})=>{var t;if(l.value?(console.log(`[FFmpegè½¬æ¢] ${a}`),f(a)):(a.includes("Duration:")||a.includes("Video:")||a.includes("Audio:"))&&console.log(`[FFmpegä¿¡æ¯] ${a}`),a.includes("Duration:")){const s=a.match(/Duration: (\d{2}):(\d{2}):(\d{2}\.\d{2})/);if(s){const v=parseInt(s[1]),w=parseInt(s[2]),M=parseFloat(s[3]),_=v*3600+w*60+M;c.value||(c.value={duration:0,fps:30,resolution:"æœªçŸ¥",bitrate:"æœªçŸ¥",videoCodec:"æœªçŸ¥",audioCodec:"æœªçŸ¥"}),c.value.duration=_}}if(a.includes("Video:")){console.log("è§£æè§†é¢‘ä¿¡æ¯è¡Œ:",a);const s=a.match(/(\d{3,4})x(\d{3,4})/),v=a.match(/(\d+) fps/),w=a.match(/Video: (\w+)/),M=a.match(/(\d+) kb\/s/);if(c.value||(c.value={duration:0,fps:30,resolution:"æœªçŸ¥",bitrate:"æœªçŸ¥",videoCodec:"æœªçŸ¥",audioCodec:"æœªçŸ¥"}),s){const _=parseInt(s[1]),X=parseInt(s[2]);_>=100&&X>=100?(c.value.resolution=`${_}x${X}`,console.log("è§£æåˆ°åˆ†è¾¨ç‡:",c.value.resolution)):console.log("åˆ†è¾¨ç‡å€¼ä¸åˆç†ï¼Œè·³è¿‡:",_,"x",X)}v&&(c.value.fps=parseInt(v[1]),console.log("è§£æåˆ°å¸§ç‡:",c.value.fps)),w&&(c.value.videoCodec=w[1],console.log("è§£æåˆ°è§†é¢‘ç¼–è§£ç å™¨:",c.value.videoCodec)),M&&(c.value.bitrate=`${M[1]} kb/s`,console.log("è§£æåˆ°æ¯”ç‰¹ç‡:",c.value.bitrate))}if(a.includes("Audio:")){const s=a.match(/Audio: (\w+)/);c.value||(c.value={duration:0,fps:30,resolution:"æœªçŸ¥",bitrate:"æœªçŸ¥",videoCodec:"æœªçŸ¥",audioCodec:"æœªçŸ¥"}),s&&(c.value.audioCodec=s[1])}if(a.includes("frame=")){const s=a.match(/frame=\s*(\d+)/);if(s&&l.value){const v=parseInt(s[1]),w=((t=F.value)==null?void 0:t.totalFrames)||111,M=Math.min(v/w*70,70);i.value=20+M,console.log(`[è½¬æ¢è¿›åº¦] ${v}/${w} å¸§ (${i.value.toFixed(1)}%) - ${new Date().toLocaleTimeString()}`)}}if(l.value){if(a.includes("Stream mapping:"))console.log("[è½¬æ¢é˜¶æ®µ] å¼€å§‹æµæ˜ å°„...");else if(a.includes("Output #0"))console.log("[è½¬æ¢é˜¶æ®µ] å¼€å§‹è¾“å‡º...");else if(a.includes("frame=")&&a.includes("fps=")){const s=a.match(/fps=\s*(\d+)/);s&&console.log(`[è½¬æ¢æ€§èƒ½] å½“å‰FPS: ${s[1]}`)}}}),p.on("progress",({progress:a,time:t})=>{console.log(`[VideoConverter] è½¬æ¢è¿›åº¦: ${a*100}%, æ—¶é—´: ${t}`),a>0&&(i.value=20+a*70)});try{n.value=!0,f("æ­£åœ¨åŠ è½½FFmpeg...");const a=setInterval(()=>{i.value<80&&(i.value+=5,f(`æ­£åœ¨åŠ è½½FFmpeg... ${i.value}%`))},200);await p.load({coreURL:await G(`${te}/ffmpeg-core.js`,"text/javascript"),wasmURL:await G(`${te}/ffmpeg-core.wasm`,"application/wasm"),workerURL:await G(`${te}/ffmpeg-core.worker.js`,"text/javascript")}),clearInterval(a),i.value=100,f("FFmpegåŠ è½½å®Œæˆï¼"),o.value=!0,n.value=!1,console.log("æ£€æŸ¥ffprobeå¯ç”¨æ€§:",typeof p.ffprobe),console.log("FFmpegå¯¹è±¡:",p),await new Promise(t=>setTimeout(t,1e3)),f("è¯·é€‰æ‹©è§†é¢‘æ–‡ä»¶å¼€å§‹è½¬æ¢"),i.value=0}catch(a){console.error("FFmpegåŠ è½½å¤±è´¥:",a),f("FFmpegåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•"),n.value=!1}});const de=async a=>{const t=a.target;t.files&&t.files[0]&&(d.value=t.files[0],h.value=null,y.value="",i.value=0,F.value=null,f(`å·²é€‰æ‹©æ–‡ä»¶: ${d.value.name}`),await oe())},ce=async a=>{var t;console.log(a),a.preventDefault(),(t=a.dataTransfer)!=null&&t.files&&a.dataTransfer.files[0]&&(d.value=a.dataTransfer.files[0],h.value=null,y.value="",i.value=0,F.value=null,f(`å·²é€‰æ‹©æ–‡ä»¶: ${d.value.name}`),await oe())},me=a=>{a.preventDefault()},oe=async()=>{if(d.value){if(!o.value){f("FFmpegå°šæœªåŠ è½½å®Œæˆï¼Œæ— æ³•è¯»å–è§†é¢‘ä¿¡æ¯");return}try{f("æ­£åœ¨è¯»å–è§†é¢‘ä¿¡æ¯..."),c.value=null;const a=Q(d.value.name);await p.writeFile(`temp_input.${a}`,await ee(d.value)),console.log("å°è¯•ä½¿ç”¨execè·å–è§†é¢‘ä¿¡æ¯...");try{if(await p.exec(["-i",`temp_input.${a}`]),c.value&&c.value.duration>0){const t=Math.round(c.value.duration*c.value.fps);F.value={duration:c.value.duration,fps:c.value.fps,totalFrames:t,resolution:c.value.resolution,bitrate:c.value.bitrate,format:a},f(`è§†é¢‘ä¿¡æ¯è¯»å–æˆåŠŸ: ${c.value.resolution}, ${c.value.duration.toFixed(2)}ç§’, ${c.value.fps}fps`),console.log("è§£æåˆ°çš„è§†é¢‘ä¿¡æ¯:",c.value)}else throw new Error("æ— æ³•è§£æè§†é¢‘ä¿¡æ¯")}catch(t){throw console.error("execå‘½ä»¤å¤±è´¥:",t),new Error("æ— æ³•è¯»å–è§†é¢‘ä¿¡æ¯")}await p.deleteFile(`temp_input.${a}`)}catch(a){console.error("è¯»å–è§†é¢‘ä¿¡æ¯å¤±è´¥:",a),f("è¯»å–è§†é¢‘ä¿¡æ¯å¤±è´¥ï¼Œæ— æ³•ç»§ç»­è½¬æ¢"),F.value=null,d.value=null}}},ve=async()=>{var a,t;if(!d.value||!p){alert("è¯·å…ˆé€‰æ‹©è§†é¢‘æ–‡ä»¶");return}console.log("=== å¼€å§‹è½¬æ¢ ==="),console.log("FFmpegå®ä¾‹:",p),console.log("é€‰æ‹©æ–‡ä»¶:",d.value.name,"å¤§å°:",(d.value.size/1024/1024).toFixed(2),"MB"),console.log("è¾“å‡ºæ ¼å¼:",P.value),console.log("è§†é¢‘è´¨é‡:",W.value),console.log("åˆ†è¾¨ç‡è®¾ç½®:",H.value),console.log("å¸§ç‡è®¾ç½®:",z.value),l.value=!0,i.value=0,f("æ­£åœ¨åŠ è½½FFmpeg...");try{if(!o.value){f("FFmpegå°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨å€™...");return}f("å¼€å§‹è½¬æ¢..."),i.value=10;const s=Q(d.value.name),v=P.value;f("æ­£åœ¨å†™å…¥è¾“å…¥æ–‡ä»¶..."),console.log("å¼€å§‹å†™å…¥è¾“å…¥æ–‡ä»¶...");const w=Date.now();await p.writeFile(`input.${s}`,await ee(d.value));const M=Date.now()-w;console.log(`æ–‡ä»¶å†™å…¥å®Œæˆï¼Œè€—æ—¶: ${M}ms`),i.value=20;const _=fe(s,v);f("å¼€å§‹è½¬æ¢..."),console.log("æ‰§è¡ŒFFmpegå‘½ä»¤:",_.join(" ")),console.log("è½¬æ¢å¼€å§‹æ—¶é—´:",new Date().toLocaleTimeString());const X=new Promise((O,J)=>{setTimeout(()=>{J(new Error("è½¬æ¢è¶…æ—¶ï¼Œè¯·å°è¯•æ›´å°çš„æ–‡ä»¶æˆ–æ›´ä½çš„è®¾ç½®"))},1e3*60)});try{const O=Date.now();await Promise.race([p.exec(_),X]);const J=Date.now()-O;console.log("FFmpegè½¬æ¢å‘½ä»¤æ‰§è¡Œå®Œæˆ"),console.log(`è½¬æ¢è€—æ—¶: ${J}ms`),console.log("è½¬æ¢ç»“æŸæ—¶é—´:",new Date().toLocaleTimeString()),i.value=90}catch(O){throw console.error("FFmpegæ‰§è¡Œé”™è¯¯:",O),console.error("é”™è¯¯è¯¦æƒ…:",O.stack),new Error(`è½¬æ¢æ‰§è¡Œå¤±è´¥: ${O.message}`)}f("æ­£åœ¨è¯»å–è¾“å‡ºæ–‡ä»¶...");const we=await p.readFile(`output.${v}`);h.value=new Blob([we.buffer],{type:`video/${v}`}),y.value=URL.createObjectURL(h.value),i.value=100,f("è½¬æ¢å®Œæˆï¼");try{const O=Q(((a=d.value)==null?void 0:a.name)||"");await p.deleteFile(`input.${O}`),await p.deleteFile(`output.${v}`),console.log("è½¬æ¢å®Œæˆï¼Œå·²æ¸…ç†ä¸´æ—¶æ–‡ä»¶")}catch(O){console.warn("æ¸…ç†ä¸´æ—¶æ–‡ä»¶å¤±è´¥:",O)}}catch(s){console.error("=== è½¬æ¢å¤±è´¥ ==="),console.error("é”™è¯¯ç±»å‹:",s.constructor.name),console.error("é”™è¯¯æ¶ˆæ¯:",s.message),console.error("é”™è¯¯å †æ ˆ:",s.stack);let v="è½¬æ¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼æˆ–é‡è¯•";s.message.includes("è¶…æ—¶")?v="è½¬æ¢è¶…æ—¶ï¼Œå»ºè®®ï¼š1. å°è¯•æ›´å°çš„æ–‡ä»¶ 2. é™ä½è§†é¢‘è´¨é‡è®¾ç½® 3. æ£€æŸ¥ç½‘ç»œè¿æ¥":s.message.includes("ç¼–ç å™¨")?v="ç¼–ç å™¨é”™è¯¯ï¼Œå»ºè®®ï¼š1. å°è¯•ä¸åŒçš„è¾“å‡ºæ ¼å¼ 2. æ£€æŸ¥è¾“å…¥æ–‡ä»¶æ˜¯å¦æŸå":s.message.includes("å†…å­˜")&&(v="å†…å­˜ä¸è¶³ï¼Œå»ºè®®ï¼š1. å…³é—­å…¶ä»–ç¨‹åº 2. å°è¯•æ›´å°çš„æ–‡ä»¶"),f(v),alert(v);try{const w=Q(((t=d.value)==null?void 0:t.name)||""),M=P.value;await p.deleteFile(`input.${w}`),await p.deleteFile(`output.${M}`),console.log("å·²æ¸…ç†ä¸´æ—¶æ–‡ä»¶")}catch(w){console.warn("æ¸…ç†ä¸´æ—¶æ–‡ä»¶å¤±è´¥:",w)}}finally{l.value=!1,n.value=!1,console.log("=== è½¬æ¢æµç¨‹ç»“æŸ ===")}},fe=(a,t)=>{const s=["-i",`input.${a}`];if(s.push("-y"),s.push("-loglevel","info"),H.value!=="original"){const w={"4k":"3840:2160","1080p":"1920:1080","720p":"1280:720","480p":"854:480"};s.push("-vf",`scale=${w[H.value]}`)}z.value!=="original"&&s.push("-r",z.value);const v=W.value==="high"?18:W.value==="medium"?23:28;switch(t){case"mp4":s.push("-c:v","libx264","-preset","ultrafast","-crf",v.toString(),"-c:a","aac","-b:a","128k");break;case"avi":s.push("-c:v","libx264","-preset","ultrafast","-crf",v.toString(),"-c:a","mp3","-b:a","128k");break;case"mov":s.push("-c:v","libx264","-preset","ultrafast","-crf",v.toString(),"-c:a","aac","-b:a","128k");break;case"mkv":s.push("-c:v","libx264","-preset","ultrafast","-crf",v.toString(),"-c:a","aac","-b:a","128k");break;case"wmv":s.push("-c:v","libx264","-preset","ultrafast","-crf",v.toString(),"-c:a","aac","-b:a","128k");break;case"flv":s.push("-c:v","libx264","-preset","ultrafast","-crf",v.toString(),"-c:a","aac","-b:a","128k");break}return s.push(`output.${t}`),console.log("FFmpegå‘½ä»¤:",s.join(" ")),s},Q=a=>{var t;return((t=a.split(".").pop())==null?void 0:t.toLowerCase())||"mp4"},pe=()=>{if(h.value&&y.value){const a=document.createElement("a");a.href=y.value,a.download=`converted.${P.value}`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}},ge=()=>{j.value=!0,S.value=!1,g.value="ç‚¹å‡»åŠ è½½FFmpeg",V.value="",E=new ie},ae=()=>{j.value=!1,E=null},be=async()=>{if(E)try{g.value="æ­£åœ¨åŠ è½½FFmpeg...";const a="https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd";E.on("log",({message:t})=>{g.value=t,console.log("[æµ‹è¯•FFmpeg]",t)}),await E.load({coreURL:await G(`${a}/ffmpeg-core.js`,"text/javascript"),wasmURL:await G(`${a}/ffmpeg-core.wasm`,"application/wasm")}),S.value=!0,g.value="FFmpegåŠ è½½å®Œæˆï¼Œç‚¹å‡»å¼€å§‹è½¬æ¢"}catch(a){console.error("æµ‹è¯•FFmpegåŠ è½½å¤±è´¥:",a),g.value=`åŠ è½½å¤±è´¥: ${a.message}`}},he=async()=>{if(!(!E||!S.value))try{g.value="å¼€å§‹è½¬æ¢...",await E.writeFile("input.webm",await ee("https://raw.githubusercontent.com/ffmpegwasm/testdata/master/Big_Buck_Bunny_180_10s.webm")),g.value="æ–‡ä»¶å†™å…¥å®Œæˆï¼Œå¼€å§‹è½¬æ¢...",await E.exec(["-i","input.webm","output.mp4"]),g.value="è½¬æ¢å®Œæˆï¼Œè¯»å–æ–‡ä»¶...";const a=await E.readFile("output.mp4");V.value=URL.createObjectURL(new Blob([a.buffer],{type:"video/mp4"})),g.value="è½¬æ¢æˆåŠŸï¼"}catch(a){console.error("æµ‹è¯•è½¬æ¢å¤±è´¥:",a),g.value=`è½¬æ¢å¤±è´¥: ${a.message}`}};return(a,t)=>(D(),Fe(Me,{title:"è§†é¢‘æ ¼å¼è½¬æ¢ - å°å·¦å­çš„å·¥å…·ç®±"},{default:Re(()=>[t[33]||(t[33]=e("div",{class:"bg-white dark:bg-gray-800 shadow-sm"},[e("div",{class:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8"},[e("div",{class:"flex items-center space-x-4"},[e("div",{class:"h-12 w-12 rounded-lg bg-blue-600 flex items-center justify-center"},[e("svg",{class:"h-8 w-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})])]),e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"è§†é¢‘æ ¼å¼è½¬æ¢"),e("p",{class:"text-gray-600 dark:text-gray-400"},"æ”¯æŒå¤šç§æ ¼å¼è§†é¢‘è½¬æ¢ï¼Œå¿«é€Ÿé«˜æ•ˆ")])])])],-1)),e("div",Ue,[e("div",Be,[e("div",Te,[e("div",Ne,[t[5]||(t[5]=e("svg",{class:"h-5 w-5 text-blue-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",je,I($.value),1)])]),e("div",Pe,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"}," é€‰æ‹©è§†é¢‘æ–‡ä»¶ ",-1)),e("div",{onDrop:ce,onDragover:me,class:De(["border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-400 transition-colors",{"border-blue-400 bg-blue-50 dark:bg-blue-900/20":d.value}])},[t[9]||(t[9]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",We,[t[7]||(t[7]=e("label",{for:"file-upload",class:"cursor-pointer bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors"}," é€‰æ‹©æ–‡ä»¶ ",-1)),e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:"video/*",onChange:de},null,32),t[8]||(t[8]=e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," æ”¯æŒ MP4, AVI, MOV, MKV, WMV ç­‰æ ¼å¼ ",-1)),d.value?(D(),L("p",He," å·²é€‰æ‹©: "+I(d.value.name),1)):C("",!0),F.value?(D(),L("div",ze,[t[6]||(t[6]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-white mb-2"}," è§†é¢‘ä¿¡æ¯ ",-1)),e("div",Xe,[e("div",null,"æ—¶é•¿: "+I(F.value.duration.toFixed(2))+"ç§’",1),e("div",null,"å¸§ç‡: "+I(F.value.fps.toFixed(2))+"fps",1),e("div",null,"æ€»å¸§æ•°: "+I(F.value.totalFrames),1),e("div",null,"åˆ†è¾¨ç‡: "+I(F.value.resolution),1),e("div",null,"æ¯”ç‰¹ç‡: "+I(F.value.bitrate),1),e("div",null,"æ ¼å¼: "+I(F.value.format),1)])])):C("",!0)])],34)]),e("div",Ke,[t[19]||(t[19]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"}," è½¬æ¢é€‰é¡¹ ",-1)),e("div",Ge,[e("div",null,[t[12]||(t[12]=e("label",{for:"output-format",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," è¾“å‡ºæ ¼å¼ ",-1)),Y(e("select",{id:"output-format","onUpdate:modelValue":t[0]||(t[0]=s=>P.value=s),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},t[11]||(t[11]=[e("option",{value:"mp4"},"MP4",-1),e("option",{value:"avi"},"AVI",-1),e("option",{value:"mov"},"MOV",-1),e("option",{value:"mkv"},"MKV",-1),e("option",{value:"wmv"},"WMV",-1),e("option",{value:"flv"},"FLV",-1)]),512),[[q,P.value]])]),e("div",null,[t[14]||(t[14]=e("label",{for:"video-quality",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," è§†é¢‘è´¨é‡ ",-1)),Y(e("select",{id:"video-quality","onUpdate:modelValue":t[1]||(t[1]=s=>W.value=s),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},t[13]||(t[13]=[e("option",{value:"high"},"é«˜è´¨é‡",-1),e("option",{value:"medium"},"ä¸­ç­‰è´¨é‡",-1),e("option",{value:"low"},"ä½è´¨é‡",-1)]),512),[[q,W.value]])]),e("div",null,[t[16]||(t[16]=e("label",{for:"resolution",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," åˆ†è¾¨ç‡ ",-1)),Y(e("select",{id:"resolution","onUpdate:modelValue":t[2]||(t[2]=s=>H.value=s),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},t[15]||(t[15]=[e("option",{value:"original"},"ä¿æŒåŸåˆ†è¾¨ç‡",-1),e("option",{value:"4k"},"4K (3840x2160)",-1),e("option",{value:"1080p"},"1080p (1920x1080)",-1),e("option",{value:"720p"},"720p (1280x720)",-1),e("option",{value:"480p"},"480p (854x480)",-1)]),512),[[q,H.value]])]),e("div",null,[t[18]||(t[18]=e("label",{for:"framerate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," å¸§ç‡ ",-1)),Y(e("select",{id:"framerate","onUpdate:modelValue":t[3]||(t[3]=s=>z.value=s),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},t[17]||(t[17]=[e("option",{value:"original"},"ä¿æŒåŸå¸§ç‡",-1),e("option",{value:"60"},"60 FPS",-1),e("option",{value:"30"},"30 FPS",-1),e("option",{value:"25"},"25 FPS",-1),e("option",{value:"24"},"24 FPS",-1)]),512),[[q,z.value]])])])]),e("div",Qe,[e("button",{onClick:ve,disabled:!d.value||!F.value||l.value||!o.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium py-3 px-8 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[l.value?(D(),L("svg",Ze,t[21]||(t[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):(D(),L("svg",qe,t[20]||(t[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"},null,-1)]))),se(" "+I(l.value?"è½¬æ¢ä¸­...":"å¼€å§‹è½¬æ¢"),1)],8,Ye),e("div",null,[e("button",{onClick:ge,class:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}," ğŸ§ª æµ‹è¯•FFmpegè½¬æ¢ ")])]),n.value?(D(),L("div",Je,[t[22]||(t[22]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"}," FFmpegåŠ è½½è¿›åº¦ ",-1)),e("div",et,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:ne({width:i.value+"%"})},null,4)]),t[23]||(t[23]=e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," æ­£åœ¨åŠ è½½FFmpegæ ¸å¿ƒæ–‡ä»¶ï¼Œè¯·ç¨å€™... ",-1))])):C("",!0),l.value&&!n.value?(D(),L("div",tt,[t[24]||(t[24]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"è½¬æ¢è¿›åº¦",-1)),e("div",ot,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:ne({width:i.value+"%"})},null,4)]),t[25]||(t[25]=e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," æ­£åœ¨è½¬æ¢ä¸­ï¼Œè¯·ç¨å€™... ",-1))])):C("",!0),h.value&&y.value?(D(),L("div",at,[e("div",{class:"flex items-center justify-between"},[t[27]||(t[27]=e("div",{class:"flex items-center"},[e("svg",{class:"h-5 w-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"text-green-800 dark:text-green-200"},"è½¬æ¢å®Œæˆï¼")],-1)),e("button",{onClick:pe,class:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition-colors"},t[26]||(t[26]=[e("svg",{class:"inline-block h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),se(" ä¸‹è½½æ–‡ä»¶ ",-1)]))])])):C("",!0)]),t[28]||(t[28]=e("div",{class:"mt-8 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8"},[e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"åŠŸèƒ½è¯´æ˜"),e("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"}," æ”¯æŒçš„è¾“å…¥æ ¼å¼ "),e("ul",{class:"text-gray-600 dark:text-gray-400 space-y-1"},[e("li",null,"â€¢ MP4 (H.264, H.265)"),e("li",null,"â€¢ AVI (Xvid, DivX)"),e("li",null,"â€¢ MOV (QuickTime)"),e("li",null,"â€¢ MKV (Matroska)"),e("li",null,"â€¢ WMV (Windows Media)"),e("li",null,"â€¢ FLV (Flash Video)")])]),e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"}," æ”¯æŒçš„è¾“å‡ºæ ¼å¼ "),e("ul",{class:"text-gray-600 dark:text-gray-400 space-y-1"},[e("li",null,"â€¢ MP4 (H.264, H.265)"),e("li",null,"â€¢ AVI (Xvid)"),e("li",null,"â€¢ MOV (QuickTime)"),e("li",null,"â€¢ MKV (Matroska)"),e("li",null,"â€¢ WMV (Windows Media)"),e("li",null,"â€¢ FLV (Flash Video)")])])]),e("div",{class:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md"},[e("div",{class:"flex items-start"},[e("svg",{class:"h-5 w-5 text-blue-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("div",null,[e("h4",{class:"text-sm font-medium text-blue-800 dark:text-blue-200"}," éšç§ä¿æŠ¤ "),e("p",{class:"text-sm text-blue-700 dark:text-blue-300 mt-1"}," æ‰€æœ‰è§†é¢‘è½¬æ¢éƒ½åœ¨æ‚¨çš„æµè§ˆå™¨æœ¬åœ°è¿›è¡Œï¼Œæ–‡ä»¶ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç¡®ä¿æ‚¨çš„éšç§å®‰å…¨ã€‚ ")])])])],-1))]),j.value?(D(),L("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:ae},[e("div",{class:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",onClick:t[4]||(t[4]=Le(()=>{},["stop"]))},[e("div",{class:"flex justify-between items-center mb-4"},[t[30]||(t[30]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," ğŸ§ª FFmpegè½¬æ¢æµ‹è¯• ",-1)),e("button",{onClick:ae,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},t[29]||(t[29]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",lt,[e("div",rt,[e("p",st,I(g.value),1)]),e("div",nt,[S.value?C("",!0):(D(),L("button",{key:0,onClick:be,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors"}," åŠ è½½FFmpeg (~31 MB) ")),S.value?(D(),L("button",{key:1,onClick:he,class:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md transition-colors"}," è½¬æ¢ webm åˆ° mp4 ")):C("",!0)]),V.value?(D(),L("div",it,[t[31]||(t[31]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-white"},"è½¬æ¢ç»“æœï¼š",-1)),e("video",{src:V.value,controls:"",class:"w-full rounded-md",preload:"metadata"},null,8,ut)])):C("",!0),t[32]||(t[32]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"},[e("p",null,"â€¢ æ‰“å¼€å¼€å‘è€…å·¥å…· (Ctrl+Shift+I) æŸ¥çœ‹è¯¦ç»†æ—¥å¿—"),e("p",null,"â€¢ æµ‹è¯•ä½¿ç”¨å®˜æ–¹ç¤ºä¾‹è§†é¢‘è¿›è¡Œè½¬æ¢"),e("p",null,"â€¢ ç”¨äºéªŒè¯FFmpegåŸºæœ¬åŠŸèƒ½æ˜¯å¦æ­£å¸¸")],-1))])])])):C("",!0)]),_:1,__:[33]}))}});export{vt as default};
