import{_ as y}from"./Layout.vue_vue_type_script_setup_true_lang-CjIAlh2T.js";import{t as p,f as F,F as C}from"./index-bIxDAEjd.js";import{d as M,r as c,g as _,o as a,w as B,b as e,a as i,i as m,t as v,l as g,n as j}from"./app-_eBFLlcy.js";const L={class:"max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8"},$={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8"},T={class:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md"},V={class:"flex items-center"},D={class:"text-blue-800 dark:text-blue-200"},U={class:"space-y-4 mb-8"},R={key:1,class:"space-y-4"},z={class:"mt-4"},H={key:0,class:"mt-2 text-sm text-blue-600 dark:text-blue-400"},N=["disabled"],E={key:0,class:"inline-block h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},O={key:1,class:"inline-block h-5 w-5 mr-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},S={key:0,class:"mb-8"},A={class:"bg-gray-100 dark:bg-gray-700 rounded-lg p-4"},I=["src"],J=M({__name:"VideoConverterTest",setup(K){const d=c(!1),o=c("点击加载FFmpeg"),n=c(""),r=c(null),u=c(!1);let l=null;const f=async()=>{if(l)try{o.value="正在加载FFmpeg...";const s="https://cdn.jsdelivr.net/npm/@ffmpeg/core-mt@0.12.10/dist/esm";l.on("log",({message:t})=>{o.value=t,console.log("[测试FFmpeg]",t)}),await l.load({coreURL:await p(`${s}/ffmpeg-core.js`,"text/javascript"),wasmURL:await p(`${s}/ffmpeg-core.wasm`,"application/wasm"),workerURL:await p(`${s}/ffmpeg-core.worker.js`,"text/javascript")}),d.value=!0,o.value="FFmpeg加载完成，点击开始转换"}catch(s){console.error("测试FFmpeg加载失败:",s),o.value=`加载失败: ${s.message}`}},x=async s=>{const t=s.target;t.files&&t.files[0]&&(r.value=t.files[0],n.value="",o.value=`已选择文件: ${r.value.name} (${(r.value.size/1024/1024).toFixed(2)} MB)`)},k=async s=>{var t;s.preventDefault(),(t=s.dataTransfer)!=null&&t.files&&s.dataTransfer.files[0]&&(r.value=s.dataTransfer.files[0],n.value="",o.value=`已选择文件: ${r.value.name} (${(r.value.size/1024/1024).toFixed(2)} MB)`)},b=s=>{s.preventDefault()},h=s=>{var t;return((t=s.split(".").pop())==null?void 0:t.toLowerCase())||"mp4"},w=async()=>{if(!(!l||!d.value)){if(!r.value){o.value="请先选择要转换的视频文件";return}try{u.value=!0,o.value="开始转换...";const s=h(r.value.name);console.log("转换文件:",r.value.name,"格式:",s),await l.writeFile(`input.${s}`,await F(r.value)),o.value="文件写入完成，开始转换...",await l.exec(["-i",`input.${s}`,"output.mp4"]),o.value="转换完成，读取文件...";const t=await l.readFile("output.mp4");n.value=URL.createObjectURL(new Blob([t.buffer],{type:"video/mp4"})),o.value="转换成功！"}catch(s){console.error("测试转换失败:",s),o.value=`转换失败: ${s.message}`}finally{u.value=!1}}};return(()=>{l=new C,d.value=!1,o.value="点击加载FFmpeg",n.value=""})(),(s,t)=>(a(),_(y,{title:"FFmpeg转换测试 - 小左子的工具箱"},{default:B(()=>[t[10]||(t[10]=e("div",{class:"bg-white dark:bg-gray-800 shadow-sm"},[e("div",{class:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8"},[e("div",{class:"flex items-center space-x-4"},[e("div",{class:"h-12 w-12 rounded-lg bg-green-600 flex items-center justify-center"},[e("svg",{class:"h-8 w-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])]),e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"FFmpeg转换测试"),e("p",{class:"text-gray-600 dark:text-gray-400"},"测试FFmpeg基本转换功能")])])])],-1)),e("div",L,[e("div",$,[e("div",T,[e("div",V,[t[0]||(t[0]=e("svg",{class:"h-5 w-5 text-blue-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",D,v(o.value),1)])]),e("div",U,[d.value?m("",!0):(a(),i("button",{key:0,onClick:f,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},t[1]||(t[1]=[e("svg",{class:"inline-block h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),g(" 加载FFmpeg (~31 MB) ",-1)]))),d.value?(a(),i("div",R,[t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"},"选择视频文件",-1)),e("div",{onDrop:k,onDragover:b,class:j(["border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 dark:hover:border-blue-400 transition-colors",{"border-blue-400 bg-blue-50 dark:bg-blue-900/20":r.value}])},[t[4]||(t[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",z,[t[2]||(t[2]=e("label",{for:"file-upload",class:"cursor-pointer bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors"}," 选择文件 ",-1)),e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:"video/*",onChange:x},null,32),t[3]||(t[3]=e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," 支持 MP4, AVI, MOV, MKV, WMV 等格式 ",-1)),r.value?(a(),i("p",H," 已选择: "+v(r.value.name),1)):m("",!0)])],34),e("button",{onClick:w,disabled:!r.value||u.value,class:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium py-3 px-6 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},[u.value?(a(),i("svg",O,t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):(a(),i("svg",E,t[5]||(t[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))),g(" "+v(u.value?"转换中...":"开始转换"),1)],8,N)])):m("",!0)]),n.value?(a(),i("div",S,[t[8]||(t[8]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"转换结果：",-1)),e("div",A,[e("video",{src:n.value,controls:"",class:"w-full rounded-md",preload:"metadata"},null,8,I)])])):m("",!0),t[9]||(t[9]=e("div",{class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"测试说明"),e("div",{class:"space-y-3 text-sm text-gray-600 dark:text-gray-400"},[e("div",{class:"flex items-start"},[e("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),e("span",null,"打开开发者工具 (Ctrl+Shift+I) 查看详细日志")]),e("div",{class:"flex items-start"},[e("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),e("span",null,"支持拖拽上传或点击选择视频文件")]),e("div",{class:"flex items-start"},[e("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),e("span",null,"用于验证FFmpeg基本功能是否正常")]),e("div",{class:"flex items-start"},[e("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),e("span",null,"测试网络连接和CDN是否正常")]),e("div",{class:"flex items-start"},[e("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),e("span",null,"所有转换都在浏览器本地进行，保护隐私")])])],-1))])])]),_:1,__:[10]}))}});export{J as default};
